import{s as p}from"../../../assets/index-chunk.js";import{n as m}from"../../../assets/index-chunk2.js";var b=Object.defineProperty,w=Object.getOwnPropertyDescriptor,y=(d,s,e,r)=>{for(var o=r>1?void 0:r?w(s,e):s,t=d.length-1,i;t>=0;t--)(i=d[t])&&(o=(r?i(s,e,o):i(o))||o);return r&&o&&b(s,e,o),o};class A extends p{constructor(){super(...arguments),this.open=!1,this._setListeners=!1}handleTriggerSlotChange(s){s.target.assignedElements().forEach(o=>{var t,i,l,u,n;this._button=(t=o.shadowRoot)==null?void 0:t.querySelector("button"),(i=this._button)==null||i.setAttribute("aria-haspopup","true"),(l=this._button)==null||l.setAttribute("aria-expanded",this.open?"true":"false"),(u=this._button)==null||u.addEventListener("click",()=>{var a;this.open=!this.open,this.focusFirstMenuItem(),(a=this._button)==null||a.setAttribute("aria-expanded",this.open?"true":"false")}),(n=this._button)==null||n.addEventListener("keydown",a=>{this._setListeners=!0,a.key==="ArrowDown"&&this.handleArrowDown(a)})})}focusFirstMenuItem(){setTimeout(()=>{var e,r;(r=(e=this.querySelectorAll(":scope > nsc-menu-item, :scope > nsc-submenu")[0].shadowRoot)==null?void 0:e.querySelector("a"))==null||r.focus()})}handleItemSlotChange(s){var o,t;const r=s.target.assignedElements();for(let[i,l]of r.entries()){const u=l.tagName.toLowerCase();if(u==="nsc-menu-item"||u==="nsc-submenu"){l.setAttribute("role","listitem");let n=(o=l.shadowRoot)==null?void 0:o.querySelector("a");if(n==null||n.setAttribute("role","menuitem"),i===0?n==null||n.setAttribute("tabindex","0"):n==null||n.setAttribute("tabindex","-1"),!this._setListeners){let a=(t=l.shadowRoot)==null?void 0:t.querySelectorAll("li");if(a)for(let h of a)h.addEventListener("keydown",c=>{var f;this._setListeners=!0,c.key==="ArrowDown"?this.handleArrowDown(c):c.key==="ArrowUp"?this.handleArrowUp(c):c.key==="Tab"?this.handleClose():c.key==="Escape"&&(this.handleClose(),(f=this._button)==null||f.focus())})}}}}handleClose(){this.open=!1;const s=this.querySelectorAll("nsc-submenu");if(s)for(let e of s)e.open=!1}handleArrowDown(s){var i,l,u,n;s.preventDefault();const e=this.querySelectorAll(":scope > nsc-menu-item, :scope > nsc-submenu"),r=this.querySelector(":focus");let o=Array.from(e).indexOf(r);o===-1&&((l=(i=e[0].shadowRoot)==null?void 0:i.querySelector("a"))==null||l.focus());let t=o+1;t>e.length-1&&(t=0),(n=(u=e[t].shadowRoot)==null?void 0:u.querySelector("a"))==null||n.focus()}handleArrowUp(s){var i,l;s.preventDefault();const e=this.querySelectorAll(":scope > nsc-menu-item, :scope > nsc-submenu"),r=this.querySelector(":focus");let t=Array.from(e).indexOf(r)-1;t<0&&(t=e.length-1),(l=(i=e[t].shadowRoot)==null?void 0:i.querySelector("a"))==null||l.focus()}}y([m({type:Boolean})],A.prototype,"open",2);export{A as N};
